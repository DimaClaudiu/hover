<style type="text/css">
    @import url("../../../styles/monokai.css");
    @import url("../../../styles/juniper.css");
</style>

<div>
Start by loading or creating a dataset:
</div>
<pre data-executable>
from hover.core.dataset import SupervisableTextDataset
from faker import Faker
import random

fake_en = Faker("en")

def random_text():
    return fake_en.paragraph(3)

def random_raw_data():
    return {"content": random_text()}

def random_labeled_data():
    return {"content": random_text(), "mark": random.choice(["A", "B"])}

dataset = SupervisableTextDataset(
    raw_dictl=[random_raw_data() for i in range(500)],
    train_dictl=[],
    dev_dictl=[random_labeled_data() for i in range(50)],
    test_dictl=[random_labeled_data() for i in range(50)],
    feature_key="content",
    label_key="mark",
)

dataset.dfs["raw"].head(5)
</pre><br>

<div>
Define a vectorizer for feature extraction:
</div>
<pre data-executable>
import spacy
import re

nlp = spacy.load("en_core_web_md")

def vectorizer(text):
    clean_text = re.sub(r"[\s]+", r" ", text)
    return nlp(clean_text, disable=nlp.pipe_names).vector

text = dataset.dictls["raw"][0]["text"]
vec = vectorizer(text)
print(f"Text: {text}")
print(f"Vector shape: {vec.shape}")

</pre><br>

<div>
Use the vectorizer and manifold learning to cast the dataset to 2D, then create our annotation interface:
</div>
<pre data-executable>
from hover.recipes import simple_annotator
from bokeh.io import show, output_notebook

output_notebook()

dataset.compute_2d_embedding(vectorizer, "umap")

handle = simple_annotator(dataset)

show(handle)
</pre><br>

<script src="../../../plugins/juniper.min.js"></script>
<script>
    new Juniper({
        repo: 'phurwicz/hover-binder',
        isolateCells: false,
        theme: 'monokai'
    })
</script>
